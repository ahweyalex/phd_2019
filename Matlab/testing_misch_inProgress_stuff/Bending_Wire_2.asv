% Alexander Moreno
% DATE: 06-19-2021
% ver: 0.2
%
% description: going to "bend" coil 

clear all; close all; clc;
%%
%=========================================================================%
%%-------------------MULTI-LAYER COIL PARAMETERS-------------------------%%
%=========================================================================%
Nxy1    = 1;            % number of coils <scalar>
%N       = 9;            % number of turns in z-direction <scalar>
N       = 2;            % number of turns in z-direction <scalar>
ra1     = 10e-3;        % y-axis <scalar> [m]
ri1     = 15e-3;        % x-axis <scalar> [m]
%=========================================================================%
wT      = 0.2546e-3;    % 30AWG wire gauge <scalar> [m]
%O       = 0;            % starting orientation: <scalar> [unitless] 1/0
O       = 1;            % rect
I1      = 1;            % current <scalar> [A]
u0      = 4*pi*10^-7;   % free space permeability <scalar> [H/m]
L1      = ra1;          % y-axis <scalar> [m]
W1      = ri1;          % x-axis <scalar> [m]
%=========================================================================%
numSeg  = 200*6;          % number of points along each coil <scalar>
gap     = 0;            % gap <scalar> [m]
h       = wT*0.35;      % height of structure
zEnd    = N*2*pi*h;     % final z-value 
ANT1    = struct('NXY',Nxy1,'N',N,'ra',ra1,'ri',ri1);
%=========================================================================%
% self-inductance
X11=[];Y11=[];Z11=[]; BX11=[];BY11=[];BZ11=[];
SELF_IND = struct('X11',  X11,'Y11',  Y11,'Z11',  Z11,...
                  'BX11',BX11,'BY11',BY11,'BZ11',BZ11);
%%
%=========================================================================%
%%--------------------------CONSTRUCT COIL--------------------------------%%
%=========================================================================%
SEL1='e';  % indicator for ellipse self or mutual inductance 
[sx30,sy30,sz30] = constrCircWire(h,ra1,ri1,numSeg,N,O,wT,Nxy1);
%=========================================================================%
%%-----------------------<<NEW CODE: BENDING>>---------------------------%%
%=========================================================================%
clc; close all;
NUM4  = ((numel(sz30)/N)/Nxy1)/4;
bRad  = 20e-3; % [m]
bCurv =  bRad.*sin(linspace(0,pi/2,NUM4));
count = 0; 
for idx=1:numel(sx30)
    
    if(count==NUM4)     % go up
        szB(idx) = sz30(idx) + bCurv(idx);
        count = count+1;
    elseif(count==0) % go down
        count = count+1;
    end
end

%%
%=========================================================================%
%%-----------------------------PlOTTING----------------------------------%%
%=========================================================================%
FS=10;
hold all;
figure(1)
H = plot3(sx30./1e-3, sy30./1e-3, sz30./1e-3);      
set(H(1),'color','r'); 
xlabel('x[mm]','FontSize', FS, 'Color', 'r', 'FontWeight', 'bold'); 
ylabel('y[mm]','FontSize', FS, 'Color', 'g', 'FontWeight', 'bold'); 
zlabel('z[mm]','FontSize', FS, 'Color', 'b', 'FontWeight', 'bold');
title('Example Nxy:1 N:3','FontSize', FS,...
    'FontWeight', 'bold');
S30 = [sx30,sy30,sz30]';
view(140,45); grid on;
hold on;